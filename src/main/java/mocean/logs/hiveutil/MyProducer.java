package mocean.logs.hiveutil;

import kafka.javaapi.producer.Producer;
import kafka.producer.KeyedMessage;
import kafka.producer.ProducerConfig;
import mocean.logs.common.Common;

import java.util.List;
import java.util.Properties;

public class MyProducer {
    private static Producer<String, String> producer;
    private final Properties props = new Properties();

    public MyProducer() {
        props.put( "metadata.broker.list", "185.180.221.108:9092" );
        props.put( "serializer.class", "kafka.serializer.StringEncoder" );
        props.put( "request.required.acks", "1" );
        producer = new Producer<String, String>( new ProducerConfig( props ) );
    }

    public static void main(String[] args) {
        MyProducer sp = new MyProducer();
        String topic = "cdnlog3";
//        String messageStr ="{\"server\":\"190.7.145.151\",\"clients\":[{\"protocol\":\"HTTP\",\"address\":\"196.64.7.36:11175\",\"channel_id\":\"TV6052\",\"authinfo\":\"1555438462$$105.159.226.137$$1$$12345abcde$$0000000018051100293420190417021419183$$-1\",\"sn\":\"180511002934\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"176.186.99.23:1251\",\"channel_id\":\"TV7023\",\"authinfo\":\"1554675971$$176.186.99.23$$1$$12345abcde$$0000000017111501682520190408062553404$$-1\",\"sn\":\"171115016825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"90.59.10.140:2432\",\"channel_id\":\"TV7032\",\"authinfo\":\"1555501999$$90.59.10.140$$1$$12345abcde$$0000000017042400137620190417194153602$$-1\",\"sn\":\"170424001376\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":3,\"stream_total_len\":2,\"stream_lose_len\":1,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"193.150.18.94:28959\",\"channel_id\":\"TV4001@2000\",\"authinfo\":\"1555530626$$193.150.18.94$$1$$12345abcde$$0000000018051100902720190418035015149$$-1\",\"sn\":\"180511009027\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"82.233.181.218:3891\",\"channel_id\":\"TV6160\",\"authinfo\":\"1555599622$$82.233.181.218$$1$$12345abcde$$0000000018042302782520190418225817306$$-1\",\"sn\":\"180423027825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"176.186.99.23:1252\",\"channel_id\":\"TV7023\",\"authinfo\":\"1554675971$$176.186.99.23$$1$$12345abcde$$0000000017111501682520190408062553404$$-1\",\"sn\":\"171115016825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943}]}";
        String messageStr ="{\"server\":\"190.2.145.151\",\"clients\":[{\"protocol\":\"HTTP\",\"address\":\"196.64.7.36:11175\",\"channel_id\":\"TV6052\",\"authinfo\":\"1555438462$$105.159.226.137$$1$$12345abcde$$0000000018051100293420190417021419183$$-1\",\"sn\":\"180511002934\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":0,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"176.186.99.23:1251\",\"channel_id\":\"TV7023\",\"authinfo\":\"1554675971$$176.186.99.23$$1$$12345abcde$$0000000017111501682520190408062553404$$-1\",\"sn\":\"171115016825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":1,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"90.59.10.140:2432\",\"channel_id\":\"TV7032\",\"authinfo\":\"1555501999$$90.59.10.140$$1$$12345abcde$$0000000017042400137620190417194153602$$-1\",\"sn\":\"170424001376\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"193.150.18.94:28959\",\"channel_id\":\"TV4001@2000\",\"authinfo\":\"1555530626$$193.150.18.94$$1$$12345abcde$$0000000018051100902720190418035015149$$-1\",\"sn\":\"180511009027\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":1,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"82.233.181.218:3891\",\"channel_id\":\"TV6160\",\"authinfo\":\"1555599622$$82.233.181.218$$1$$12345abcde$$0000000018042302782520190418225817306$$-1\",\"sn\":\"180423027825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"176.186.99.23:1252\",\"channel_id\":\"TV7023\",\"authinfo\":\"1554675971$$176.186.99.23$$1$$12345abcde$$0000000017111501682520190408062553404$$-1\",\"sn\":\"171115016825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943}]}";
//        String messageStr ="{\"server\":\"190.2.145.151\",\"clients\":[{\"protocol\":\"HTTP\",\"address\":\"196.64.7.36:11175\",\"channel_id\":\"TV6052\",\"authinfo\":\"1555438462$$105.159.226.137$$1$$12345abcde$$0000000018051100293420190417021419183$$-1\",\"sn\":\"180511002934\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"176.186.99.23:1251\",\"channel_id\":\"TV7023\",\"authinfo\":\"1554675971$$176.186.99.23$$1$$12345abcde$$0000000017111501682520190408062553404$$-1\",\"sn\":\"171115016825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"90.59.10.140:2432\",\"channel_id\":\"TV7032\",\"authinfo\":\"1555501999$$90.59.10.140$$1$$12345abcde$$0000000017042400137620190417194153602$$-1\",\"sn\":\"170424001376\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"193.150.18.94:28959\",\"channel_id\":\"TV4001@2000\",\"authinfo\":\"1555530626$$193.150.18.94$$1$$12345abcde$$0000000018051100902720190418035015149$$-1\",\"sn\":\"180511009027\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"82.233.181.218:3891\",\"channel_id\":\"TV6160\",\"authinfo\":\"1555599622$$82.233.181.218$$1$$12345abcde$$0000000018042302782520190418225817306$$-1\",\"sn\":\"180423027825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943},{\"protocol\":\"HTTP\",\"address\":\"176.186.99.23:1252\",\"channel_id\":\"TV7023\",\"authinfo\":\"1554675971$$176.186.99.23$$1$$12345abcde$$0000000017111501682520190408062553404$$-1\",\"sn\":\"171115016825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1555638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1555638943}]}";
        String messageStr1 ="{\"server\":\"19.7.145.151\",\"clients\":[{\"protocol\":\"HTTP\",\"address\":\"196.64.7.36:11175\",\"channel_id\":\"TV6052\",\"authinfo\":\"1555438462$$105.159.226.137$$1$$12345abcde$$0000000018051100293420190417021419183$$-1\",\"sn\":\"180511002934\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"176.186.99.23:1251\",\"channel_id\":\"TV7023\",\"authinfo\":\"1554675971$$176.186.99.23$$1$$12345abcde$$0000000017111501682520190408062553404$$-1\",\"sn\":\"171115016825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"90.59.10.140:2432\",\"channel_id\":\"TV7032\",\"authinfo\":\"1555501999$$90.59.10.140$$1$$12345abcde$$0000000017042400137620190417194153602$$-1\",\"sn\":\"170424001376\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"193.150.18.94:28959\",\"channel_id\":\"TV4001@2000\",\"authinfo\":\"1555530626$$193.150.18.94$$1$$12345abcde$$0000000018051100902720190418035015149$$-1\",\"sn\":\"180511009027\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"82.233.181.218:3891\",\"channel_id\":\"TV6160\",\"authinfo\":\"1555599622$$82.233.181.218$$1$$12345abcde$$0000000018042302782520190418225817306$$-1\",\"sn\":\"180423027825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943},{\"protocol\":\"HTTP\",\"address\":\"176.186.99.23:1252\",\"channel_id\":\"TV7023\",\"authinfo\":\"1554675971$$176.186.99.23$$1$$12345abcde$$0000000017111501682520190408062553404$$-1\",\"sn\":\"171115016825\",\"note\":\"901\",\"user_agent\":\"Lavf53.5.0\",\"connect_status\":2,\"connect_time\":1565638943,\"stream_duration\":0,\"stream_speed\":0,\"stream_total_len\":0,\"stream_lose_len\":0,\"current_time\":1565638943}]}";
//        KeyedMessage<String, String> data = new KeyedMessage<String, String>( topic, messageStr );
        KeyedMessage<String, String> data = new KeyedMessage<String, String>( topic, "1" );
        KeyedMessage<String, String> data2 = new KeyedMessage<String, String>( topic, "2" );
        KeyedMessage<String, String> data3 = new KeyedMessage<String, String>( topic, "3" );
//            producer.send( data );
//            producer.close();
        List<KeyedMessage<String, String>> messageList = Common.getMessageList();
//        if(messageList.size()!=3){
            messageList.add( data );
            messageList.add( data2 );
            messageList.add( data3 );
//            return;
//        }

        producer.send(data3 );
//        producer.send( data );
        producer.close();
        System.out.println( "ok" );

    }

}
